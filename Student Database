CREATE TABLE DEPARTMENT (DNO NUMBER (2), DNAME VARCHAR2(20));
ALTER TABLE DEPARTMENT ADD PRIMARY KEY (DNO);

#Cretae Branch table
CREATE TABLE BRANCH (BCODE NUMBER (3), BNAME VARCHAR2 (25),DNO NUMBER (2));
ALTER TABLE BRANCH ADD PRIMARY KEY (BCODE);
ALTER TABLE BRANCH ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO);

#Create Course table
CREATE TABLE COURSE (CCODE NUMBER (4), CNAME VARCHAR2 (25),CREDITS NUMBER (2), DNO NUMBER (2));
ALTER TABLE COURSE ADD PRIMARY KEY (CCODE);
ALTER TABLE COURSE ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO));

#Create Branch course table
CREATE TABLE BRANCH_COURSE(BCODE INT, CCODE INT);
ALTER TABLE BRANCH_COURSE ADD PRIMARY KEY (BCODE, CCODE);
ALTER TABLE BRANCH_COURSE ADD FOREIGN KEY (BCODE) REFERENCES BRANCH (BCODE);
ALTER TABLE BRANCH_COURSE ADD FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE);

#Create Student table
CREATE TABLE STUDENT (ROLLNO NUMBER (5),NAME VARCHAR2 (20),DOB DATE, GENDER CHAR(2),DOA DATE, BCODE NUMBER(3));
ALTER TABLE STUDENT ADD PRIMARY KEY (ROLLNO);
ALTER TABLE STUDENT ADD FOREIGN KEY (BCODE) REFERENCESBRANCH (BCODE);
ALTER TABLE ADD CONSTRAINT CHK CHECK (GENDER IN ('M','F'));
ALTER TABLE ADD CONSTRAINT CHK2 CHECK (DOA &lt; TO_DATE('31-4-2016,'DD-MM-YYYY');

#Create Enrolls table
CREATE TABLE ENROLLS (ROLLNO NUMBER (5), CCODE NUMBER (4),SESS VARCHAR2 (15), GRADE CHAR (2));
ALTER TABLE ENROLLS ADD PRIMARY KEY (ROLLNO, CCODE, SESS);
ALTER TABLE ENROLLS ADD FOREIGN KEY ROLLNO) REFERENCES STUDENT (ROLLNO);
ALTER TABLE ENROLLS ADD FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE);

#Insert Department data
INSERT INTO DEPARTMENT VALUES (01, 'DBMS');
INSERT INTO DEPARTMENT VALUES (02, 'AR');
INSERT INTO DEPARTMENT VALUES (03, 'VR');
INSERT INTO DEPARTMENT VALUES (01, 'DBMS');
INSERT INTO DEPARTMENT VALUES (02, 'AR');

#Insert Branch data
INSERT INTO BRANCH VALUES (15, 057);
INSERT INTO BRANCH VALUES (27, 032);
INSERT INTO BRANCH VALUES (32, 014);
INSERT INTO BRANCH VALUES (01, 057);
INSERT INTO BRANCH VALUES (13, 032);

#Insert Course data
INSERT INTO COURSE (057, 'DBMS', 4, 01);
INSERT INTO COURSE (032, 'AR', 4, 02);
INSERT INTO COURSE (014, 'VR', 4, 03);
INSERT INTO COURSE (057, 'DBMS', 4, 01);
INSERT INTO COURSE (032, 'AR', 4, 02);

#Insert Branch course data
INSERT INTO BRANCH_COURSE VALUES (15, '057');
INSERT INTO BRANCH_COURSE VALUES (27, '032');
INSERT INTO BRANCH_COURSE VALUES (32, '014');
INSERT INTO BRANCH_COURSE VALUES (01, '057');
INSERT INTO BRANCH_COURSE VALUES (13, '032');

#Insert Student data
INSERT INTO STUDENT (015, 'SURYA', 29-01-02, M, 2019, 15);
INSERT INTO STUDENT (027, 'AJAY', 20-03-02, M, 2019, 27);
INSERT INTO STUDENT (032, 'ARUN', 17-05-01, M, 2019, 32);
INSERT INTO STUDENT (001, 'SAM', 02-08-02, M, 2019, 01);
INSERT INTO STUDENT (013, 'VAMSI', 14-06-02, M, 2019, 13);

#Insert Enrolls data
INSERT INTO ENROLLS (015, 057, 'APRIL2013', 'A');
INSERT INTO ENROLLS (027, 032, 'APRIL2013', 'S');
INSERT INTO ENROLLS (532, 014, 'APRIL2013', 'A');
INSERT INTO ENROLLS (001, 057, 'APRIL2013', 'S');
INSERT INTO ENROLLS (013, 032, 'APRIL2013', 'S');

SELECT * FROM DEPARTMENT D WHERE D.DNO IN (SELECT B.DNO FROM BRANCH B GROUP BY B.DNO HAVING COUNT (B.DNO) > 3);

SELECT * FROM DEPARTMENT D WHERE D.DNO IN (SELECT C.DNO FROM COURSE C GROUP BY C.DNO HAVING COUNT (C.CCODE) > 6);

SELECT * FROM COURSE C WHERE C.CCODE IN (SELECT B.CCODE FROMBRANCH_COURSE B GROUP BY B.CCODE HAVING COUNT (B.BCODE) >3);
SELECT * FROM STUDENT S WHERE S.ROLLNO IN (SELECT E.ROLLNO FROM ENROLLS E WHERE E.GRADE = 'S' GROUP BY E.ROLLNO HAVING COUNT (E.GRADE) > 2);

CREATE VIEW STUDATA AS SELECT E.ROLLNO, S.NAME, COUNT (E.CCODE) AS CC FROM STUDENT S, ENROLLS E WHERE E.ROLLNO = S.ROLLNO AND E.GRADE ! = 'U' GROUP BY E.ROLLNO, S.NAME;
